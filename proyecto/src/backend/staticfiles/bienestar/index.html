<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="manifest" href="/static/manifest.json" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="/static/css/students-theme.css" />
  <link rel="stylesheet" href="/static/css/styles.css" />
  <meta name="theme-color" content="#1a1a1a">
  <title>Bienestar - StudentsPoint</title>
</head>
<body>
  <div class="particles-bg"></div>
  
  <header class="students-header text-white">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-md-8">
          <div class="students-logo">
            <img src="/imagenes/logos-iconos/Logo_StudentsPoint.svg.png" alt="StudentsPoint Logo" class="students-logo-img">
            <div>
              <h1>Bienestar StudentsPoint</h1>
              <p>Cuida tu salud física y mental</p>
            </div>
          </div>
        </div>
        <div class="col-md-4 text-end">
          <div class="auth-buttons">
            <a href="/" class="btn btn-outline-primary btn-sm">
              <i class="fas fa-home"></i> Inicio
            </a>
            <a href="/login.html" class="btn btn-primary btn-sm">
              <i class="fas fa-sign-in-alt"></i> Iniciar Sesión
            </a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <nav class="navbar navbar-expand-lg students-nav">
    <div class="container">
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav me-auto">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
              <i class="fas fa-th-large"></i> Aplicaciones
            </a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="/forum/"><i class="fas fa-comments"></i> Foros</a></li>
              <li><a class="dropdown-item" href="/market/"><i class="fas fa-store"></i> Mercado</a></li>
              <li><a class="dropdown-item" href="/portfolio/"><i class="fas fa-briefcase"></i> Portafolio</a></li>
              <li><a class="dropdown-item" href="/bienestar/"><i class="fas fa-heart-pulse"></i> Bienestar</a></li>
              <li><a class="dropdown-item" href="/cursos/"><i class="fas fa-graduation-cap"></i> Cursos</a></li>
              <li><a class="dropdown-item" href="/horarios/"><i class="fas fa-calendar"></i> Horarios</a></li>
              <li><a class="dropdown-item" href="/encuestas/"><i class="fas fa-poll"></i> Encuestas</a></li>
              <li><a class="dropdown-item" href="/reportes/"><i class="fas fa-chart-bar"></i> Reportes</a></li>
              <li><a class="dropdown-item" href="/streetview/"><i class="fas fa-map"></i> Recorridos Virtuales</a></li>
              <li><a class="dropdown-item" href="/teachers.html"><i class="fas fa-chalkboard-teacher"></i> Profesores</a></li>
              <li><a class="dropdown-item" href="/account.html"><i class="fas fa-user"></i> Mi Cuenta</a></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <main class="main-content" style="position: relative; z-index: 2;">
    <div class="container mt-3">
      <!-- Hero Section -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card bg-gradient-primary text-white">
            <div class="card-body text-center py-5">
              <i class="fas fa-heart-pulse fa-3x mb-3"></i>
              <h2>Centro de Bienestar Estudiantil</h2>
              <p class="lead">Tu salud física y mental es nuestra prioridad. Encuentra recursos, consejos y apoyo profesional.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Navegación por categorías -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="btn-group w-100" role="group">
            <button type="button" class="btn btn-outline-primary active" onclick="showCategory('all')">
              <i class="fas fa-th-large"></i> Todos
            </button>
            <button type="button" class="btn btn-outline-primary" onclick="showCategory('mental')">
              <i class="fas fa-brain"></i> Salud Mental
            </button>
            <button type="button" class="btn btn-outline-primary" onclick="showCategory('fisica')">
              <i class="fas fa-dumbbell"></i> Salud Física
            </button>
            <button type="button" class="btn btn-outline-primary" onclick="showCategory('nutricion')">
              <i class="fas fa-apple-alt"></i> Nutrición
            </button>
            <button type="button" class="btn btn-outline-primary" onclick="showCategory('emergencia')">
              <i class="fas fa-phone"></i> Emergencias
            </button>
          </div>
        </div>
      </div>

      <!-- Contenido dinámico -->
      <div id="bienestarContent">
        <!-- Salud Mental -->
        <div class="row mb-4" id="mentalSection">
          <div class="col-12">
            <h3 class="mb-3"><i class="fas fa-brain text-primary"></i> Salud Mental</h3>
          </div>
          <div class="col-md-6 mb-3">
            <div class="card h-100">
              <div class="card-body">
                <h5 class="card-title"><i class="fas fa-head-side-virus text-info"></i> Manejo del Estrés</h5>
                <p class="card-text">Técnicas y estrategias para manejar el estrés académico y personal.</p>
                <ul class="list-unstyled">
                  <li><i class="fas fa-check text-success"></i> Técnicas de respiración</li>
                  <li><i class="fas fa-check text-success"></i> Mindfulness y meditación</li>
                  <li><i class="fas fa-check text-success"></i> Gestión del tiempo</li>
                  <li><i class="fas fa-check text-success"></i> Ejercicios de relajación</li>
                </ul>
                <button class="btn btn-primary" onclick="showResource('estres')">
                  <i class="fas fa-play"></i> Ver Recursos
                </button>
              </div>
            </div>
          </div>
          <div class="col-md-6 mb-3">
            <div class="card h-100">
              <div class="card-body">
                <h5 class="card-title"><i class="fas fa-bed text-warning"></i> Calidad del Sueño</h5>
                <p class="card-text">Consejos para mejorar tu descanso y rendimiento académico.</p>
                <ul class="list-unstyled">
                  <li><i class="fas fa-check text-success"></i> Rutinas de sueño</li>
                  <li><i class="fas fa-check text-success"></i> Higiene del sueño</li>
                  <li><i class="fas fa-check text-success"></i> Técnicas de relajación</li>
                  <li><i class="fas fa-check text-success"></i> Apps de seguimiento</li>
                </ul>
                <button class="btn btn-primary" onclick="showResource('sueño')">
                  <i class="fas fa-play"></i> Ver Recursos
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Salud Física -->
        <div class="row mb-4" id="fisicaSection">
          <div class="col-12">
            <h3 class="mb-3"><i class="fas fa-dumbbell text-success"></i> Salud Física</h3>
          </div>
          <div class="col-md-4 mb-3">
            <div class="card h-100">
              <div class="card-body text-center">
                <i class="fas fa-running fa-2x text-primary mb-3"></i>
                <h5 class="card-title">Ejercicio en Casa</h5>
                <p class="card-text">Rutinas de ejercicio que puedes hacer sin salir de casa.</p>
                <button class="btn btn-primary" onclick="showResource('ejercicio')">
                  <i class="fas fa-play"></i> Ver Rutinas
                </button>
              </div>
            </div>
          </div>
          <div class="col-md-4 mb-3">
            <div class="card h-100">
              <div class="card-body text-center">
                <i class="fas fa-walking fa-2x text-success mb-3"></i>
                <h5 class="card-title">Actividad Física</h5>
                <p class="card-text">Consejos para mantenerte activo durante el estudio.</p>
                <button class="btn btn-primary" onclick="showResource('actividad')">
                  <i class="fas fa-play"></i> Ver Consejos
                </button>
              </div>
            </div>
          </div>
          <div class="col-md-4 mb-3">
            <div class="card h-100">
              <div class="card-body text-center">
                <i class="fas fa-eye fa-2x text-info mb-3"></i>
                <h5 class="card-title">Cuidado Visual</h5>
                <p class="card-text">Protege tus ojos durante las largas sesiones de estudio.</p>
                <button class="btn btn-primary" onclick="showResource('visual')">
                  <i class="fas fa-play"></i> Ver Consejos
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Nutrición -->
        <div class="row mb-4" id="nutricionSection">
          <div class="col-12">
            <h3 class="mb-3"><i class="fas fa-apple-alt text-warning"></i> Nutrición</h3>
          </div>
          <div class="col-md-6 mb-3">
            <div class="card h-100">
              <div class="card-body">
                <h5 class="card-title"><i class="fas fa-utensils text-warning"></i> Alimentación Saludable</h5>
                <p class="card-text">Consejos nutricionales para estudiantes.</p>
                <div class="row">
                  <div class="col-6">
                    <h6>Desayuno</h6>
                    <ul class="list-unstyled small">
                      <li>• Avena con frutas</li>
                      <li>• Yogurt con granola</li>
                      <li>• Huevos revueltos</li>
                    </ul>
                  </div>
                  <div class="col-6">
                    <h6>Snacks</h6>
                    <ul class="list-unstyled small">
                      <li>• Frutos secos</li>
                      <li>• Frutas frescas</li>
                      <li>• Hummus con vegetales</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6 mb-3">
            <div class="card h-100">
              <div class="card-body">
                <h5 class="card-title"><i class="fas fa-tint text-info"></i> Hidratación</h5>
                <p class="card-text">La importancia de mantenerse hidratado durante el estudio.</p>
                <div class="progress mb-2">
                  <div class="progress-bar bg-info" style="width: 75%">75% Hidratado</div>
                </div>
                <p class="small text-muted">Recomendación: 8 vasos de agua al día</p>
                <button class="btn btn-outline-info btn-sm" onclick="startHydrationTracker()">
                  <i class="fas fa-plus"></i> Registrar Vaso
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Emergencias -->
        <div class="row mb-4" id="emergenciaSection">
          <div class="col-12">
            <h3 class="mb-3"><i class="fas fa-phone text-danger"></i> Líneas de Emergencia</h3>
          </div>
          <div class="col-md-4 mb-3">
            <div class="card border-danger">
              <div class="card-body text-center">
                <i class="fas fa-phone fa-2x text-danger mb-3"></i>
                <h5 class="card-title">Emergencias</h5>
                <p class="card-text">Línea de emergencia 24/7</p>
                <a href="tel:133" class="btn btn-danger">
                  <i class="fas fa-phone"></i> 133
                </a>
              </div>
            </div>
          </div>
          <div class="col-md-4 mb-3">
            <div class="card border-warning">
              <div class="card-body text-center">
                <i class="fas fa-heart fa-2x text-warning mb-3"></i>
                <h5 class="card-title">Salud Mental</h5>
                <p class="card-text">Apoyo psicológico</p>
                <a href="tel:6003607777" class="btn btn-warning">
                  <i class="fas fa-phone"></i> 600 360 7777
                </a>
              </div>
            </div>
          </div>
          <div class="col-md-4 mb-3">
            <div class="card border-info">
              <div class="card-body text-center">
                <i class="fas fa-user-md fa-2x text-info mb-3"></i>
                <h5 class="card-title">Consulta Médica</h5>
                <p class="card-text">Atención médica virtual</p>
                <a href="tel:6003607777" class="btn btn-info">
                  <i class="fas fa-phone"></i> 600 360 7777
                </a>
              </div>
            </div>
          </div>
        </div>

        <!-- Recursos Adicionales -->
        <div class="row mb-4">
          <div class="col-12">
            <h3 class="mb-3"><i class="fas fa-book text-primary"></i> Recursos Adicionales</h3>
          </div>
          <div class="col-md-6 mb-3">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title"><i class="fas fa-calendar-check text-success"></i> Planificador de Bienestar</h5>
                <p class="card-text">Crea tu plan personalizado de bienestar.</p>
                <button class="btn btn-success" onclick="openWellnessPlanner()">
                  <i class="fas fa-plus"></i> Crear Plan
                </button>
              </div>
            </div>
          </div>
          <div class="col-md-6 mb-3">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title"><i class="fas fa-chart-line text-info"></i> Seguimiento de Progreso</h5>
                <p class="card-text">Monitorea tu progreso en bienestar.</p>
                <button class="btn btn-info" onclick="openProgressTracker()">
                  <i class="fas fa-chart-bar"></i> Ver Progreso
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Modal para recursos -->
  <div class="modal fade" id="resourceModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="resourceModalTitle">Recurso</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body" id="resourceModalBody">
          <!-- Contenido dinámico -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
        </div>
      </div>
    </div>
  </div>

  <footer class="students-footer">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-md-6">
          <h5 class="gradient-text">Bienestar StudentsPoint</h5>
          <p>Tu salud y bienestar son fundamentales para tu éxito académico.</p>
        </div>
        <div class="col-md-6 text-end">
          <p class="mb-0"><i class="fas fa-heart"></i> Cuida tu mente y cuerpo</p>
        </div>
      </div>
    </div>
  </footer>

  <div class="dev-tools" style="display: none;">
    <button onclick="window.StudentsPointPWA?.clearCache()" title="Limpiar Cache"><i class="fas fa-sync-alt"></i></button>
    <button onclick="window.StudentsPointPWA?.getVersion()" title="Versión"><i class="fas fa-info-circle"></i></button>
    <button onclick="window.open('/admin/', '_blank')" title="Administración"><i class="fas fa-cog"></i></button>
    <button onclick="window.open('/api/', '_blank')" title="API"><i class="fas fa-code"></i></button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/static/js/sounds.js"></script>
  <script src="/static/js/pwa.js"></script>
  <script src="/static/pwa-config.js"></script>
  <script src="/static/js/main.js"></script>

  <script>
    let currentUser = null;
    let hydrationCount = 0;
    let wellnessData = JSON.parse(localStorage.getItem('wellnessData') || '{}');

    if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
      document.querySelector('.dev-tools').style.display = 'flex';
    }

    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(() => {
        if (window.playSound) {
          window.playSound('pageLoad');
        }
      }, 500);
      
      // Verificar autenticación
      checkAuth();
      
      // Cargar datos de bienestar
      loadWellnessData();
    });

    async function checkAuth() {
      const token = localStorage.getItem('access_token');
      if (token) {
        try {
          const response = await fetch('/api/auth/me/', {
            headers: {
              'Authorization': `Bearer ${token}`
            }
          });
          if (response.ok) {
            currentUser = await response.json();
            updateUI();
          }
        } catch (error) {
          console.error('Error verificando autenticación:', error);
        }
      }
    }

    function updateUI() {
      if (currentUser) {
        // Actualizar botones de autenticación
        const authButtons = document.querySelector('.auth-buttons');
        authButtons.innerHTML = `
          <span class="text-white me-2">Hola, ${currentUser.name}</span>
          <a href="/account.html" class="btn btn-outline-primary btn-sm">
            <i class="fas fa-user"></i> Mi Cuenta
          </a>
          <button class="btn btn-danger btn-sm ms-2" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i> Salir
          </button>
        `;
      }
    }

    function loadWellnessData() {
      // Cargar datos de hidratación
      hydrationCount = wellnessData.hydrationCount || 0;
      updateHydrationDisplay();
    }

    function showCategory(category) {
      // Actualizar botones activos
      document.querySelectorAll('.btn-group .btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      
      // Mostrar/ocultar secciones
      const sections = ['mentalSection', 'fisicaSection', 'nutricionSection', 'emergenciaSection'];
      
      sections.forEach(sectionId => {
        const section = document.getElementById(sectionId);
        if (category === 'all' || sectionId.includes(category)) {
          section.style.display = 'block';
        } else {
          section.style.display = 'none';
        }
      });
    }

    function showResource(resourceType) {
      const modal = new bootstrap.Modal(document.getElementById('resourceModal'));
      const title = document.getElementById('resourceModalTitle');
      const body = document.getElementById('resourceModalBody');
      
      const resources = {
        'estres': {
          title: 'Manejo del Estrés',
          content: `
            <h6>Técnicas de Respiración</h6>
            <p>La respiración profunda es una de las técnicas más efectivas para reducir el estrés:</p>
            <ol>
              <li>Inhala lentamente por la nariz durante 4 segundos</li>
              <li>Mantén la respiración durante 4 segundos</li>
              <li>Exhala lentamente por la boca durante 6 segundos</li>
              <li>Repite 5-10 veces</li>
            </ol>
            
            <h6>Mindfulness</h6>
            <p>Practica la atención plena para reducir la ansiedad:</p>
            <ul>
              <li>Meditación de 10 minutos diarios</li>
              <li>Ejercicios de atención plena</li>
              <li>Técnicas de relajación muscular</li>
            </ul>
          `
        },
        'sueño': {
          title: 'Calidad del Sueño',
          content: `
            <h6>Rutina de Sueño Saludable</h6>
            <p>Establece una rutina consistente para mejorar tu descanso:</p>
            <ul>
              <li>Acuéstate y levántate a la misma hora todos los días</li>
              <li>Evita pantallas 1 hora antes de dormir</li>
              <li>Crea un ambiente fresco, oscuro y silencioso</li>
              <li>Evita cafeína después de las 2 PM</li>
            </ul>
            
            <h6>Apps Recomendadas</h6>
            <ul>
              <li>Sleep Cycle - Monitoreo del sueño</li>
              <li>Headspace - Meditación para dormir</li>
              <li>Calm - Sonidos relajantes</li>
            </ul>
          `
        },
        'ejercicio': {
          title: 'Ejercicio en Casa',
          content: `
            <h6>Rutina de 20 minutos</h6>
            <p>Ejercicios que puedes hacer sin equipamiento:</p>
            <ol>
              <li>Calentamiento (5 min): Movimientos suaves</li>
              <li>Cardio (10 min): Saltos, burpees, mountain climbers</li>
              <li>Fuerza (5 min): Flexiones, sentadillas, plancha</li>
            </ol>
            
            <h6>Apps de Ejercicio</h6>
            <ul>
              <li>Nike Training Club - Rutinas gratuitas</li>
              <li>7 Minute Workout - Entrenamientos cortos</li>
              <li>Yoga Studio - Clases de yoga</li>
            </ul>
          `
        }
      };
      
      const resource = resources[resourceType];
      if (resource) {
        title.textContent = resource.title;
        body.innerHTML = resource.content;
        modal.show();
      }
    }

    function startHydrationTracker() {
      hydrationCount++;
      wellnessData.hydrationCount = hydrationCount;
      localStorage.setItem('wellnessData', JSON.stringify(wellnessData));
      updateHydrationDisplay();
      showSuccess('¡Vaso de agua registrado!');
    }

    function updateHydrationDisplay() {
      const progress = Math.min((hydrationCount / 8) * 100, 100);
      const progressBar = document.querySelector('.progress-bar');
      if (progressBar) {
        progressBar.style.width = `${progress}%`;
        progressBar.textContent = `${Math.round(progress)}% Hidratado`;
      }
    }

    function openWellnessPlanner() {
      showSuccess('Planificador de bienestar en desarrollo');
    }

    function openProgressTracker() {
      showSuccess('Seguimiento de progreso en desarrollo');
    }

    function logout() {
      localStorage.removeItem('access_token');
      localStorage.removeItem('refresh_token');
      window.location.href = '/login.html';
    }

    function showSuccess(message) {
      const alertDiv = document.createElement('div');
      alertDiv.className = 'alert alert-success alert-dismissible fade show';
      alertDiv.innerHTML = `${message}<button type="button" class="btn-close" data-bs-dismiss="alert"></button>`;
      const container = document.querySelector('.container');
      container.insertBefore(alertDiv, container.firstChild);
      setTimeout(() => {
        if (alertDiv.parentNode) {
          alertDiv.remove();
        }
      }, 3000);
    }
  </script>

  <style>
    .bg-gradient-primary {
      background: linear-gradient(135deg, #0066CC, #00CC66);
    }
    
    .card {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    }
    
    .btn-group .btn {
      border-radius: 0;
    }
    
    .btn-group .btn:first-child {
      border-top-left-radius: 0.375rem;
      border-bottom-left-radius: 0.375rem;
    }
    
    .btn-group .btn:last-child {
      border-top-right-radius: 0.375rem;
      border-bottom-right-radius: 0.375rem;
    }
  </style>
</body>
</html>